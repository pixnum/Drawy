<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Drawy - 2025</title>
<style>
    body {margin:0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display:flex; justify-content:center; align-items:center; height:100vh; background:#f0f0f0;}
    .app-frame {position:relative; border:2px solid #ccc; border-radius:20px; padding:20px; background:#fff; display:flex; flex-direction:column; align-items:center; max-width:1000px; width:90%;}
    .toolbar {display:flex; justify-content:space-between; width:100%; margin-bottom:10px;}
    .left-toolbar, .right-toolbar {display:flex; gap:10px; align-items:center;}
    select, input[type=color], button, input[type=range] {border:none; border-radius:10px; padding:5px 10px; cursor:pointer;}
    button {background:#e0e0e0;}
    button:hover {background:#ccc;}
    #color-picker {width:40px; height:40px; padding:0;}
    .recent-colors {display:flex; gap:5px;}
    .color-swatch {width:30px; height:30px; border-radius:50%; border:1px solid #999; cursor:pointer;}
    canvas {border:1px solid #aaa; border-radius:10px; touch-action:none;}
    .dark-mode {background:#333; color:#eee; border-color:#555;}
</style>
</head>
<body>
<div class="app-frame" id="app-frame">
    <div class="toolbar">
        <div class="left-toolbar">
            <select id="brush-selector"></select>
            <label>Size:<input type="range" id="brush-size" min="1" max="50" value="5"></label>
            <select id="bg-selector"></select>
            <label>Brightness:<input type="range" id="bg-brightness" min="0" max="2" step="0.01" value="1"></label>
            <input type="color" id="color-picker" value="#000000">
            <div class="recent-colors" id="recent-colors"></div>
        </div>
        <div class="right-toolbar">
            <button id="undo-btn">Undo</button>
            <button id="redo-btn">Redo</button>
            <button id="reset-btn">Reset</button>
            <button id="save-png-btn">Save PNG</button>
            <button id="save-jpg-btn">Save JPG</button>
            <button id="dark-mode-btn">ðŸŒ™</button>
        </div>
    </div>
    <canvas id="draw-canvas"></canvas>
    <div style="margin-top:10px;">Â© Drawy 2025</div>
</div>
<script>
// ----- Initialization -----
const canvas = document.getElementById('draw-canvas');
const ctx = canvas.getContext('2d');
let drawing = false;
let brushColor = '#000000';
let brushSize = 5;
let brushType = 'Pencil';
let bgColor = '#ffffff';
let bgBrightness = 1;
let undoStack = [];
let redoStack = [];
const recentColors = [];

// ----- Responsive Canvas -----
function resizeCanvas(){
    const frame = document.getElementById('app-frame');
    canvas.width = Math.min(frame.clientWidth - 40, 1000);
    canvas.height = Math.min(window.innerHeight*0.6, 600);
    drawBackground();
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

// ----- Brushes (named by function) -----
const brushes = [
  'Pencil','Pen','Marker','Highlighter','Airbrush','Oil Brush','Watercolor','Charcoal','Pastel','Calligraphy',
  'Round Brush','Flat Brush','Filbert','Fan Brush','Rake Brush','Texture Brush','Splatter','Pattern Brush','Blender','Smudge',
  'Eraser','Chisel Tip','Soft Round','Hard Round','Soft Square','Hard Square','Spray','Ink Pen','Fountain Pen','Dip Pen',
  'Crayon','Graphite','Chalk','Sponge','Stencil','Edge Brush','Detail Brush','Highlight Brush','Shadow Brush','Glow Brush',
  'Stamp Brush','Noise Brush','Pixel Brush','Dot Brush','Line Brush','Curve Brush','Gradient Brush','Blend Brush','Contour Brush','Shape Brush'
];
const brushSelector = document.getElementById('brush-selector');
brushes.forEach(b=>{let opt=document.createElement('option');opt.value=b;opt.textContent=b;brushSelector.appendChild(opt);});
brushSelector.addEventListener('change',(e)=>{brushType=e.target.value;});

// ----- Brush Size -----
const brushSizeInput = document.getElementById('brush-size');
brushSizeInput.addEventListener('input',(e)=>{brushSize=parseInt(e.target.value);});

// ----- Backgrounds -----
const backgrounds = ['White','LightGray','Gray','DarkGray','Black','Red','Orange','Yellow','Green','Blue','Indigo','Violet','Cyan','Magenta','Pink','Brown','Beige','LightBlue','LightGreen','Gradient1','Gradient2','Gradient3','Texture1','Texture2','Texture3'];
const bgSelector = document.getElementById('bg-selector');
backgrounds.forEach(b=>{let opt=document.createElement('option');opt.value=b;opt.textContent=b;bgSelector.appendChild(opt);});
bgSelector.addEventListener('change',()=>{bgColor=bgSelector.value;drawBackground();});

// ----- Background Brightness -----
const bgBrightnessInput = document.getElementById('bg-brightness');
bgBrightnessInput.addEventListener('input',(e)=>{bgBrightness=parseFloat(e.target.value); drawBackground();});

function drawBackground(){
    ctx.globalAlpha = 1;
    let fillStyle;
    if(bgColor.startsWith('Gradient')){
        let grad = ctx.createLinearGradient(0,0,canvas.width,canvas.height);
        grad.addColorStop(0,'#ff9a9e');
        grad.addColorStop(1,'#fad0c4');
        fillStyle = grad;
    } else if(bgColor.startsWith('Texture')){
        fillStyle = '#ddd';
    } else {
        fillStyle = bgColor;
    }
    ctx.fillStyle = fillStyle;
    ctx.fillRect(0,0,canvas.width,canvas.height);

    ctx.globalCompositeOperation = 'source-atop';
    ctx.fillStyle = `rgba(255,255,255,${bgBrightness-1})`;
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.globalCompositeOperation = 'source-over';
}
drawBackground();

// ----- Color Picker -----
const colorPicker = document.getElementById('color-picker');
colorPicker.addEventListener('change',(e)=>{brushColor=e.target.value; updateRecentColors(e.target.value);});
function updateRecentColors(color){
    if(recentColors.includes(color)) return;
    recentColors.unshift(color);
    if(recentColors.length>5) recentColors.pop();
    const rcDiv = document.getElementById('recent-colors');
    rcDiv.innerHTML='';
    recentColors.forEach(c=>{
        let sw = document.createElement('div');
        sw.className='color-swatch';
        sw.style.background=c;
        sw.addEventListener('click',()=>{brushColor=c;colorPicker.value=c;});
        rcDiv.appendChild(sw);
    });
}

// ----- Drawing Functionality (more precise) -----
function startDraw(x, y){
    drawing=true;
    ctx.beginPath();
    ctx.moveTo(x, y);
}

function draw(x, y){
    if(!drawing) return;
    ctx.strokeStyle = brushColor;
    ctx.lineWidth = brushSize;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';

    // Modify behavior based on brush type
    switch(brushType){
        case 'Highlighter': ctx.globalAlpha=0.3; break;
        case 'Airbrush': ctx.globalAlpha=0.1; break;
        case 'Oil Brush': ctx.globalAlpha=0.8; break;
        case 'Watercolor': ctx.globalAlpha=0.5; ctx.shadowBlur=5; ctx.shadowColor=brushColor; break;
        case 'Charcoal': ctx.globalAlpha=0.6; ctx.lineWidth=brushSize*1.5; break;
        case 'Pastel': ctx.globalAlpha=0.7; ctx.lineWidth=brushSize*1.2; break;
        case 'Eraser': ctx.strokeStyle = bgColor; ctx.globalAlpha=1; break;
        default: ctx.globalAlpha=1; ctx.shadowBlur=0; break;
    }

    ctx.lineTo(x,y);
    ctx.stroke();
}

function endDraw(){
    if(drawing){
        drawing=false;
        undoStack.push(ctx.getImageData(0,0,canvas.width,canvas.height));
        redoStack=[];
        ctx.shadowBlur=0;
        ctx.globalAlpha=1;
    }
}

canvas.addEventListener('pointerdown',(e)=>startDraw(e.offsetX, e.offsetY));
canvas.addEventListener('pointermove',(e)=>draw(e.offsetX, e.offsetY));
canvas.addEventListener('pointerup',endDraw);
canvas.addEventListener('touchstart',(e)=>{e.preventDefault(); const rect=canvas.getBoundingClientRect(); const t=e.touches[0]; startDraw(t.clientX-rect.left, t.clientY-rect.top);});
canvas.addEventListener('touchmove',(e)=>{e.preventDefault(); const rect=canvas.getBoundingClientRect(); const t=e.touches[0]; draw(t.clientX-rect.left, t.clientY-rect.top);});
canvas.addEventListener('touchend',(e)=>{e.preventDefault(); endDraw();});

// ----- Undo/Redo -----
document.getElementById('undo-btn').addEventListener('click',()=>{if(undoStack.length>0){redoStack.push(ctx.getImageData(0,0,canvas.width,canvas.height)); const imgData=undoStack.pop();ctx.putImageData(imgData,0,0);}});
document.getElementById('redo-btn').addEventListener('click',()=>{if(redoStack.length>0){undoStack.push(ctx.getImageData(0,0,canvas.width,canvas.height)); const imgData=redoStack.pop();ctx.putImageData(imgData,0,0);}});

// ----- Reset -----
document.getElementById('reset-btn').addEventListener('click',()=>{drawBackground();undoStack=[];redoStack=[];});

// ----- Save -----
document.getElementById('save-png-btn').addEventListener('click',()=>{let link=document.createElement('a');link.download='drawy.png';link.href=canvas.toDataURL('image/png');link.click();});
document.getElementById('save-jpg-btn').addEventListener('click',()=>{let link=document.createElement('a');link.download='drawy.jpg';link.href=canvas.toDataURL('image/jpeg');link.click();});

// ----- Dark Mode -----
document.getElementById('dark-mode-btn').addEventListener('click',()=>{document.getElementById('app-frame').classList.toggle('dark-mode');});
</script>
</body>
</html>
